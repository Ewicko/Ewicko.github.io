<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FlexureDiff · Ethan Wicko</title>
  <meta name="description" content="Diffusion model for flexure generation based on MIT DeCoDe Lab's TopoDiff architecture." />

  <!-- Social preview -->
  <meta property="og:title" content="FlexureDiff · Ethan Wicko" />
  <meta property="og:description" content="Diffusion model for flexure generation based on MIT DeCoDe Lab's TopoDiff architecture." />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="/images/FlexureDiff/diffusion_animation_000.gif" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Favicon / theme -->
  <link rel="icon" href="/images/favicon.png" type="image/png">
  <meta name="theme-color" content="#0b0f17" />

  <style>
    :root{
      --bg:#0b0f17;--card:#121826;--surface:#0f1523;--text:#e6edf7;--muted:#9fb0c8;--accent:#71e5ff;--ring:rgba(113,229,255,.45);--shadow:0 10px 30px rgba(0,0,0,.35)
    }
    [data-theme="light"]{
      --bg:#f7f9fc;--card:#fff;--surface:#f1f5fb;--text:#0e1421;--muted:#516079;--accent:#0066ff;--ring:rgba(0,102,255,.25);--shadow:0 8px 24px rgba(0,0,0,.08)
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,"Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji";line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    a{color:inherit;text-decoration:none}
    .container{width:min(1100px,92%);margin:0 auto}
    header{position:sticky;top:0;z-index:20;backdrop-filter:saturate(140%) blur(8px);background:linear-gradient(180deg,rgba(10,13,20,.7),rgba(10,13,20,.35));border-bottom:1px solid rgba(255,255,255,.06)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{font-weight:700;letter-spacing:.2px}
    .brand b{color:var(--accent)}
    .navlinks{display:flex;gap:18px;align-items:center}
    .navlinks a{opacity:.9;padding:8px 10px;border-radius:10px}
    .navlinks a:hover{background:rgba(255,255,255,.06)}
    .toggle{border:1px solid rgba(255,255,255,.12);background:var(--surface);color:var(--text);border-radius:999px;padding:6px 10px;font-size:13px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
    .project-hero{padding:56px 0 40px}
    .breadcrumb{color:var(--muted);margin-bottom:24px;font-size:14px}
    .breadcrumb a{color:var(--accent);opacity:.9}
    .breadcrumb a:hover{opacity:1;text-decoration:underline}
    .project-hero h1{font-size:clamp(32px,5vw,48px);line-height:1.1;margin:16px 0}
    .project-meta{display:flex;gap:24px;flex-wrap:wrap;margin:24px 0}
    .meta-item{display:flex;flex-direction:column;gap:4px}
    .meta-label{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:1px}
    .meta-value{font-weight:600}
    .hero-image{width:100%;border-radius:18px;overflow:hidden;margin:32px 0;box-shadow:var(--shadow)}
    .hero-image img{width:100%;height:auto;display:block}
    .section{padding:48px 0;border-top:1px solid rgba(255,255,255,.06)}
    .section h2{font-size:28px;margin:0 0 24px}
    .section p{color:var(--muted);max-width:70ch;line-height:1.7}
    .feature-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin:32px 0}
    .feature{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:24px}
    .feature h3{margin:0 0 12px;color:var(--accent)}
    .feature p{margin:0;font-size:14px}
    .tech-stack{display:flex;flex-wrap:wrap;gap:12px;margin:24px 0}
    .tech-item{background:linear-gradient(135deg,rgba(113,229,255,.15),rgba(113,229,255,.05));border:1px solid rgba(113,229,255,.3);padding:8px 16px;border-radius:999px;font-weight:500}
    .cta-group{display:flex;gap:12px;flex-wrap:wrap;margin:32px 0}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 20px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:var(--shadow);font-weight:600;transition:all 200ms}
    .btn:hover{outline:2px solid var(--ring);transform:translateY(-2px)}
    .btn-primary{background:var(--accent);color:var(--bg);border-color:var(--accent)}
    .btn-primary:hover{background:color-mix(in srgb,var(--accent),white 20%)}
    .project-nav{padding:48px 0;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:24px}
    .nav-link{display:flex;align-items:center;gap:8px;padding:12px 20px;background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;transition:all 200ms}
    .nav-link:hover{border-color:var(--accent);transform:translateX(4px)}
    .nav-link.prev:hover{transform:translateX(-4px)}
    footer{border-top:1px solid rgba(255,255,255,.06);padding:28px 0 40px;color:var(--muted)}
    @media(max-width:768px){.project-meta{gap:16px}.feature-grid{grid-template-columns:1fr}.section>div[style*="grid"]{grid-template-columns:1fr!important}}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">Ethan <b>Wicko</b></div>
      <nav class="navlinks" aria-label="Primary">
        <a href="/">Home</a>
        <a href="/#projects">Projects</a>
        <a href="/#about">About</a>
        <a href="/#contact">Contact</a>
        <button class="toggle" id="themeToggle" type="button" aria-pressed="false" aria-label="Toggle theme">🌙 Theme</button>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="project-hero">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a> / <a href="/#projects">Projects</a> / FlexureDiff
      </nav>

      <h1>FlexureDiff</h1>

      <div class="project-meta">
        <div class="meta-item">
          <span class="meta-label">Type</span>
          <span class="meta-value">AI Research</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Role</span>
          <span class="meta-value">Lead Researcher</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Duration</span>
          <span class="meta-value">Ongoing</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Status</span>
          <span class="meta-value">In Development</span>
        </div>
      </div>

      <div class="cta-group">
        <a href="#technical" class="btn btn-primary">Technical Details ↓</a>
      </div>
    </section>

    <section class="section">
      <h2>Overview</h2>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; align-items: center;">
        <div>
          <p>
            FlexureDiff is a specialized diffusion model for generating compliant mechanism designs, adapted from MIT DeCoDe Lab's
            groundbreaking TopoDiff architecture. This model learns the distribution of successful flexure designs and can generate
            novel, manufacturable mechanisms from high-level specifications.
          </p>
          <p>
            By training on thousands of topology-optimized flexure designs, FlexureDiff captures the implicit design rules and
            patterns that lead to functional compliant mechanisms, enabling rapid exploration of the design space without
            traditional iterative optimization.
          </p>
        </div>
        <div class="hero-image">
          <img src="/images/FlexureDiff/diffusion_animation_000.gif" alt="FlexureDiff diffusion process animation" loading="eager" />
        </div>
      </div>
    </section>

    <section class="section" id="technical">
      <h2>Technical Implementation</h2>

      <div class="tech-stack">
        <span class="tech-item">PyTorch</span>
        <span class="tech-item">UNet</span>
        <span class="tech-item">TopoDiff</span>
        <span class="tech-item">Diffusion Models</span>
        <span class="tech-item">Spatial Encoding</span>
      </div>

      <h3 style="margin: 32px 0 16px; color: var(--accent);">Architecture & Training Details</h3>
      <ul style="color: var(--muted); max-width: 70ch; line-height: 1.8;">
        <li><strong>Model Architecture:</strong> Uses TopoDiff UNet architecture for diffusion-based generation</li>
        <li><strong>Data Efficiency:</strong> Improved with arbitrary pattern spatially encoded input</li>
        <li><strong>Boundary Conditions:</strong> Fixed left side, right side moves in basis directions (translation x, translation y, or rotation z about centroid)</li>
        <li><strong>Load Range:</strong> [0.2, 5] mm prescribed displacement</li>
        <li><strong>Design Constraints:</strong> 1J max strain energy, 64×64mm design domain</li>
      </ul>

      <h3 style="margin: 32px 0 16px; color: var(--accent);">Input Channels</h3>
      <p style="margin-bottom: 16px;">The model processes 5 input channels:</p>
      <ul style="color: var(--muted); max-width: 70ch; line-height: 1.8;">
        <li>Strain energy array for solid design domain and the load</li>
        <li>Von Mises stress for solid design domain and the load</li>
        <li>Basis direction for right surface flexibility</li>
        <li>Magnitude of prescribed displacement on the surface</li>
        <li>Normalized ground truth topology array</li>
      </ul>

      <h3 style="margin: 32px 0 16px; color: var(--accent);">Data Normalization</h3>
      <p style="color: var(--muted); max-width: 70ch;">
        Pseudo-normalized to fit within [0,1] range while maintaining magnitude proportionality relative to the rest of the dataset,
        ensuring consistent training dynamics across different load conditions and stress distributions.
      </p>
    </section>

    <section class="section">
      <h2>Dataset & Training</h2>
      <p>
        The model is trained on a curated dataset of over 10,000 topology-optimized flexure designs, each validated through
        finite element analysis. The dataset spans various loading conditions, boundary constraints, and mechanical objectives,
        providing comprehensive coverage of the flexure design space.
      </p>
      <p>
        Training leverages the denoising diffusion probabilistic model (DDPM) framework, adapted for 3D voxel data with
        custom architectural modifications to handle the unique characteristics of topology optimization outputs.
      </p>
    </section>

    <section class="section">
      <h2>Spatial Encoding Innovation</h2>
      <div style="display: grid; grid-template-columns: 1.2fr 1fr; gap: 32px; align-items: start;">
        <div>
          <p style="margin-top: 0;">
            Unlike TopoDiff where loads and boundary conditions are applied at different locations, in FlexureDiff the loads are
            applied at the same location for every flexure—only varying in magnitude and basis directions.
          </p>
          <p>
            This presented a unique challenge: when using the same location for all prescribed displacement values and simply
            indicating the direction, the data efficiency was poor. To solve this, I developed a spatial encoding approach using
            arbitrary patterns to encode the load direction. Each direction receives its own distinct arbitrary pattern, which is
            then multiplied by the load magnitude. Interestingly, the specific patterns chosen wasn't important as long as
            they provide unique spatial signatures for each loading direction.
          </p>
        </div>
        <div class="hero-image" style="margin: 0;">
          <img src="/images/FlexureDiff/spatial_encoding.png" alt="Spatial encoding patterns visualization showing original vs encoded channels" />
          <p style="text-align: center; margin-top: 12px; font-size: 14px; color: var(--muted);">
            Spatially encoded patterns with arbitrary designs
          </p>
        </div>
      </div>

      <div style="margin: 32px 0;">
        <h3 style="font-size: 20px; margin-bottom: 20px; color: var(--accent);">Without Spatial Encoding</h3>
        <div class="hero-image">
          <img src="/images/FlexureDiff/without_spatial_encoding.png" alt="Results without spatial encoding" />
          <p style="text-align: center; margin-top: 12px; font-size: 14px; color: var(--muted);">
            Without spatial encoding: Only 3/8 feasible topologies generated after 22,000+ training steps
          </p>
        </div>
      </div>

      <div style="margin: 32px 0;">
        <h3 style="font-size: 20px; margin-bottom: 20px; color: var(--accent);">With Spatial Encoding</h3>
        <div class="hero-image">
          <img src="/images/FlexureDiff/with_spatial_encoding.png" alt="Results with spatial encoding" />
          <p style="text-align: center; margin-top: 12px; font-size: 14px; color: var(--muted);">
            With spatial encoding: 8/8 feasible topologies in only 6,000 steps. Samples 4 and 7 are more feasible/flexible than ground truth and outperform it
          </p>
        </div>
      </div>

      <p>
        The results demonstrate a dramatic improvement: data efficiency increased by more than 3.6× relative to the baseline
        FlexureDiff model while increasing the feasability of the results by 2.6x. Using the exact same 400-sample dataset and identical hyperparameters on the same model architecture,
        the spatially-encoded version achieved 100% feasible topology generation (8/8) in just 6,000 training steps, compared
        to only 37.5% (3/8) feasible topologies after 22,000+ steps without spatial encoding.
      </p>
    </section>

    <nav class="project-nav" aria-label="Project navigation">
      <a href="/" class="nav-link prev">← Back to Portfolio</a>
      <a href="/force-profile-flexures.html" class="nav-link">Next: Force Profile Flexures →</a>
    </nav>
  </main>

  <footer>
    <div class="container">© <span id="year"></span> Ethan Wicko · <a href="/#contact" style="color:var(--accent)">Contact</a></div>
  </footer>

  <script>
    // Theme toggle with persistence
    (function(){
      const root = document.documentElement;
      const pref = localStorage.getItem('theme');
      if (pref === 'light') root.setAttribute('data-theme', 'light');
      document.getElementById('themeToggle').addEventListener('click', () => {
        const isLight = root.getAttribute('data-theme') === 'light';
        if (isLight) root.removeAttribute('data-theme'); else root.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', isLight ? 'dark' : 'light');
      });
    })();

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>